rules:
  - id: concat
    languages:
      - php
    message: This file is running code that has been obfuscated
    metadata:
      description: Identify when a concatenated string is passed into eval
    mode: taint
    pattern-sources:
      - patterns:
          - pattern: assert = $ARG1 . $ARG2
    pattern-sinks:
      - patterns:
          - pattern: $EVAL(...) # could make it stricter with a specified list of functions
    severity: WARNING