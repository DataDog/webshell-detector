rules:
  - id: fork-process
    languages:
      - php
    message: This file is forking a process
    metadata:
      description: Identify when a process is forked
      tags: LOW
    patterns:
      - pattern-either:
        - pattern: pcntl_fork(...)
        - patterns:
            - pattern: popen(..., $MODE)
            - metavariable-regex:
                metavariable: $MODE
                regex: ('|"")?r('|")?
        - pattern: fsockopen(...)
    severity: WARNING