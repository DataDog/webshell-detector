rules:
  - id: detect-file-download
    languages:
      - php
    message: sample
    metadata:
      description: sample
    patterns:
      - pattern: curl_setopt( ..., $FILE) # need to expand to other types of file downloads
      - metavariable-regex:
          metavariable: $FILE
          regex: (.*file:file:.*) 
    severity: WARNING